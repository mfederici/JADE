class: EITrainer
params:
  # Number of latent dimensions
  z_dim: 64

  #################
  # Architectures #
  #################

  # Encoder
  encoder:
    dropout: 0.25
    n_hidden: 128
    dist: Delta

  # Label classifier
  label_classifier:
      dropout: 0.0
      n_hidden: 128

  # Environment Classifier
  env_classifier:
    n_hidden: 128
    spectral_norm: True

  ###########################
  # Optimization parameters #
  ###########################

  # Optimizer used for the encoder and the label classifier
  optim:
    class: Adam
    params:
      lr: 0.0001

  # Adversarial optimizer used for training the environment classifier
  adv_optim:
    class: Adam
    params:
      lr: 0.0001

  # Lowers the learning rate over time
  lr_schedule:
    class: MultiStepLR
    params:
      milestones: [100000]
      gamma: 0.1
    apply_to: [opt, adv_opt]

  # Size of the training batch
  batch_size: 256

  # Adversarial objective
  adv_objective: CE

  # Adversarial optimization strategy (simultaneous/alternating)
  adv_train_type: alternating

  # Number of adversarial steps for each optimizer step (only for alternating training)
  n_adv_steps: 10

  # Parameters for the beta-scheduler
  beta_scheduler:
    class: LinearScheduler
    params:
      start_value: 0.00001
      end_value: 0.9999999
      n_iterations: 150000
      start_iteration: 10000